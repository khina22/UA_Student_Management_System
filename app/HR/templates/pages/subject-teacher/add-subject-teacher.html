{% extends 'layouts/hr_mains1.html' %}

{% block title %} Dashboard Class Teacher {% endblock title %}
<!-- Specific CSS goes HERE -->
{% block stylesheets %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
{% endblock stylesheets %}

{% block content %}
<!-- partial:../../partials/_navbar.html -->

<!-- partial -->

<!-- partial:../../partials/_settings-panel.html -->
<!-- partial -->
<!-- partial:../../partials/_sidebar.html -->

<!-- partial -->
<div class="main-panel">
    <div class="content-wrapper">
        <div class="row">
            <div class="col-12 grid-margin stretch-card">
                <div class="card">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="card-body">



                                <form action="" id="user-form" method="post">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="exampleModalLongTitle">Create New User</h5>

                                    </div>
                                    <div class="modal-body">
                                        <div class="pl-lg-4">
                                            <div class="row">
                                                <div class="col-lg-6">
                                                    <div class="form-group">
                                                        <label class="form-control-label"
                                                            for="username">Username</label>
                                                        <input type="text" name="username" id="username"
                                                            class="form-control" placeholder="Username">
                                                    </div>
                                                </div>
                                                <div class="col-lg-6">
                                                    <div class="form-group">
                                                        <label class="form-control-label" for="email">Email
                                                            address</label>
                                                        <input type="email" name="email" id="email" class="form-control"
                                                            placeholder="email address" >
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-6">
                                                    <div class="form-group">
                                                        <label class="form-control-label"
                                                            for="password">Password</label>
                                                        <input type="password" name="password" id="password"
                                                            class="form-control">
                                                    </div>
                                                </div>
                                                <div class="col-lg-6">
                                                    <div class="form-group">
                                                        <label class="form-control-label" for="role">Role</label>
                                                        <select name="role" id="role" class="form-control">
                                                            <option value="">Select Role</option>
                                                            <option value="subject_teacher">Subject Teacher</option>
                                                            
                                                        </select>
                                                    </div>
                                                </div>
                                                </div>
                                                <div class="row" id="subjectTeacher_div">
                                                    <div class="col-lg-4">
                                                        <div class="form-group row grade">
                                                            <label class="form-control-label" for="grade">Select Class</label>
                                                                <select class="form-control form-select" name="grade" id="grade">
                                                                    <option value="">---Select One---</option>
                                                                  
                                                               
                                                            </select>
                                                        </div>
                                                    </div>

                                                    <div class="col-lg-4" id="section_group" style='display:none'>
                                                        <div class="form-group">
                                                            <label class="form-control-label" for="section">Select Section</label>
                                                            <select name="section" id="section" class="form-control">
                                                                <option value="">---Select Section---</option>

                                                            </select>
                                                        </div>
                                                    </div>

                                                    <!-- <div class="col-lg-6" id="chooseStream">
                                                        <div class="form-group"> 
                                                            <label class="form-control-label" for="section">Select Stream</label>
                                                            <select name="stream" id="stream" class="form-control">
                                                                <option value="">---Select Stream---</option>
                                                                <option value="Arts">Arts</option>
                                                                <option value="Commerce">Commerce</option>
                                                                <option value="Science">Science</option>
                                                                
                                                            </select>
                                                        </div>
                                                    </div> -->

                                                    <div class="col-lg-4" id="subject_group" >
                                                        <div class="form-group">
                                                            <label class="form-control-label" for="section">Select Subject</label>
                                                            <select name="subject" id="subject" class="form-control">
                                                                <option value="">---Select Subject---</option>
                                                                
                                                                
                                                            </select>
                                                        </div>
                                                    </div>

                                            </div>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="modal-footer">

                                        <button type="submit" id="save" class="btn btn-primary">Save</button>
                                    </div>
                                </form>



                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <!-- content-wrapper ends -->
    <!-- partial:../../partials/_footer.html -->

    <!-- partial -->
</div>
<!-- main-panel ends -->

<!-- page-body-wrapper ends -->

<!-- container-scroller -->
<!-- plugins:js -->
{% endblock content %}

<!-- Specific JS goes HERE -->
{% block javascripts %}
<!-- <script src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script> -->
<!-- <script>
     function fetchUserDetails() {
        $.ajax({
            type: 'GET',
            url: '/getUserDetails',  // Modify the URL to match your Flask route
            success: function(response) {
                // Assuming response is a JSON object containing the user details
                // Set the values in the form fields
                $('#grades').val(response.class_id);
                $('#grade').val(response.class_name);
                $('#sections').val(response.section_id);
                $('#section').val(response.section);
                $('#subject').val(response.subject);
            },
            error: function() {
                // Handle error case
            }
        });
    }
    
    // Execute the fetchUserDetails function onload
    $(document).ready(function() {
        fetchUserDetails();
    });
  
    $("#save").on("click", function () {
        var form = document.getElementById("user-form");
        var data = new FormData(form);
        $.ajax({
            type: 'POST',
            url: '/saveTeacher',
            data: data,
            contentType: false,
            cache: false,
            processData: false,

            success: function (res) {
                swal("Information successfully saved", "Click Ok to continue", "success")
                    .then(function () {
                        $('#user-form').trigger('reset')
                        window.location = "/getSubjectTeacher"
                    })

            },
        });
    });

    $("#role").on("change", function(){
        let role =  $("#role").val();
        if(role === "subject_teacher"){
            $("#subjectTeacher_div").show();

        }else{
            $("#subjectTeacher_div").hide();
        }
    });

    $("#grade").on("change", function() {
    var gradeId = $(this).val();

    // Send an AJAX request to retrieve the dropdown values for the "section" select element
    $.ajax({
        type: 'GET',
        url: '/dropDownSection/' + gradeId,
        success: function(response) {
            var dropdownValues = response;

            // Get the select element for "section" and "class"
            var sectionSelect = $('select[name="section"]');
            var classSelect = $('select[name="class"]');

            // Clear the existing options
            sectionSelect.empty();
            classSelect.empty();

            // Check if there are sections available for the selected grade
            if (dropdownValues.length === 0) {
                // If no sections are available, disable the select element and display "No Section" as an option
                sectionSelect.prop("disabled", true);
                classSelect.prop("disabled", true);

                // Create and append the "No Section" option
                var noSectionOption = $('<option>');
                noSectionOption.val("no_section");
                noSectionOption.text("No Section");
                sectionSelect.append(noSectionOption);

                // Create and append the "No Class" option
                var noClassOption = $('<option>');
                noClassOption.val("no_class");
                noClassOption.text("No Class");
                classSelect.append(noClassOption);
            } else {
                // If sections are available, enable the select elements and populate them with the options
                sectionSelect.prop("disabled", false);
                classSelect.prop("disabled", false);

                // Add the default "Select Section" and "Select Class" options at the top
                var selectSectionOption = $('<option>');
                selectSectionOption.val("");
                selectSectionOption.text("---Select Section---");
                sectionSelect.append(selectSectionOption);

                var selectClassOption = $('<option>');
                selectClassOption.val("");
                selectClassOption.text("---Select Class---");
                classSelect.append(selectClassOption);

                // Create and append the new section options
                for (var i = 0; i < dropdownValues.length; i++) {
                    var option = $('<option>');
                    option.val(dropdownValues[i].id);
                    option.text(dropdownValues[i].name);
                    sectionSelect.append(option);
                }
            }
        },
        error: function() {
            // Handle error case
        }
    });
});





    
$(document).ready(() => {
    $.ajax({
        type: 'GET',
        url: '/dropDownClass',
        success: function(response) {
            // Assuming response is the JSON array containing dropdown values
            var dropdownValues = response;
    
            // Get the select element in your HTML
            var selectElement = document.getElementById('grade');
    
            // Loop through the dropdown values and create option elements
            for (var i = 0; i < dropdownValues.length; i++) {
                var option = document.createElement('option');
                option.value = dropdownValues[i].id;
                option.textContent = dropdownValues[i].name;
                selectElement.appendChild(option);
            }
        },
        error: function() {
            // Handle error case
        }
    });
});

</script> -->


{% endblock javascripts %}